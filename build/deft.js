Ext.define("Deft.ioc.DependencyProvider",{config:{identifier:null,className:null,parameters:null,fn:null,value:null,singleton:!0,eager:!1},constructor:function(a){this.initConfig(a);null!=a.value&&a.value.constructor===Object&&this.setValue(a.value);this.getEager()&&(null!=this.getValue()&&Ext.Error.raise("Error while configuring '"+this.getIdentifier()+"': a 'value' cannot be created eagerly."),this.getSingleton()||Ext.Error.raise("Error while configuring '"+this.getIdentifier()+"': only singletons can be created eagerly."));
this.getSingleton()||null!=this.getValue()&&Ext.Error.raise("Error while configuring '"+this.getIdentifier()+"': a 'value' can only be configured as a singleton.");return this},resolve:function(a){var e;Ext.log("Resolving '"+this.getIdentifier()+"'.");if(null!=this.getValue())return this.getValue();e=null;null!=this.getFn()?(Ext.log("Executing factory function."),e=this.fn(a)):null!=this.getClassName()?(Ext.log("Creating instance of '"+this.getClassName()+"'."),a=null!=this.getParameters()?[this.getClassName()].concat(this.getParameters()):
[this.getClassName()],e=Ext.create.apply(this,a)):Ext.Error.raise("Error while configuring rule for '"+this.getIdentifier()+"': no 'value', 'fn', or 'className' was specified.");this.getSingleton()&&this.setValue(e);return e}});
Ext.define("Deft.ioc.Injector",{alternateClassName:["Deft.Injector"],requires:["Deft.ioc.DependencyProvider"],singleton:!0,constructor:function(){this.providers={};return this},configure:function(a){Ext.log("Configuring injector.");Ext.Object.each(a,function(a,b){var c;Ext.log("Configuring dependency provider for '"+a+"'.");c=Ext.isString(b)?Ext.create("Deft.ioc.DependencyProvider",{identifier:a,className:b}):Ext.create("Deft.ioc.DependencyProvider",Ext.apply({identifier:a},b));this.providers[a]=
c},this);Ext.Object.each(this.providers,function(a,b){b.getEager()&&(Ext.log("Eagerly creating '"+b.getIdentifier()+"'."),b.resolve())},this)},canResolve:function(a){return null!=this.providers[a]},resolve:function(a,e){var b;b=this.providers[a];return null!=b?b.resolve(e):Ext.Error.raise("Error while resolving value to inject: no dependency provider found for '"+a+"'.")},inject:function(a,e){var b,c,d,f;b={};Ext.isString(a)&&(a=[a]);Ext.Object.each(a,function(d,c){var f,h;h=Ext.isArray(a)?c:d;f=
this.resolve(c,e);e.config.hasOwnProperty(h)?(Ext.log("Injecting '"+c+"' into 'config."+h+"'."),b[h]=f):(Ext.log("Injecting '"+c+"' into '"+h+"'."),e[h]=f)},this);if(e.$configInited)for(c in b)f=b[c],d="set"+Ext.String.capitalize(c),e[d].call(e,f);else e.config=Ext.Object.merge({},e.config||{},b);return e}});
Ext.define("Deft.mixin.Injectable",{requires:["Deft.ioc.Injector"],onClassMixedIn:function(a){a.prototype.constructor=Ext.Function.createInterceptor(a.prototype.constructor,function(){return Deft.Injector.inject(this.inject,this)})}});
Ext.define("Deft.promise.Deferred",{alternateClassName:["Deft.Deferred"],constructor:function(){this.state="pending";this.value=this.progress=void 0;this.progressCallbacks=[];this.successCallbacks=[];this.failureCallbacks=[];this.cancelCallbacks=[];this.promise=Ext.create("Deft.Promise",this);return this},then:function(a,e,b,c){var d,f,g,i,j;Ext.isObject(a)?(f=a.success,e=a.failure,b=a.progress,a=a.cancel):(f=a,a=c);j=[f,e,b,a];g=0;for(i=j.length;g<i;g++)c=j[g],!Ext.isFunction(c)&&!(null===c||void 0===
c)&&Ext.Error.raise("Error while configuring callback: a non-function specified.");d=Ext.create("Deft.promise.Deferred");c=function(a,b){return function(c){var e;if(Ext.isFunction(a))try{e=a(c);if(e===void 0)d[b](c);else e instanceof Ext.ClassManager.get("Deft.promise.Promise")||e instanceof Ext.ClassManager.get("Deft.promise.Deferred")?e.then(Ext.bind(d.resolve,d),Ext.bind(d.reject,d),Ext.bind(d.update,d),Ext.bind(d.cancel,d)):d.resolve(e)}catch(f){d.reject(f)}else d[b](c)}};this.register(c(f,"resolve"),
this.successCallbacks,"resolved",this.value);this.register(c(e,"reject"),this.failureCallbacks,"rejected",this.value);this.register(c(a,"cancel"),this.cancelCallbacks,"cancelled",this.value);this.register(function(a){return function(b){var c;if(Ext.isFunction(a)){c=a(b);c===void 0?d.update(b):d.update(c)}else d.update(b)}}(b),this.progressCallbacks,"pending",this.progress);return d.getPromise()},always:function(a){return this.then({success:a,failure:a,cancel:a})},update:function(a){"pending"===this.state?
(this.progress=a,this.notify(this.progressCallbacks,a)):Ext.Error.raise("Error: this Deferred has already been completed and cannot be modified.")},resolve:function(a){this.complete("resolved",a,this.successCallbacks)},reject:function(a){this.complete("rejected",a,this.failureCallbacks)},cancel:function(a){this.complete("cancelled",a,this.cancelCallbacks)},getPromise:function(){return this.promise},getState:function(){return this.state},register:function(a,e,b,c){Ext.isFunction(a)&&("pending"===this.state&&
e.push(a),this.state===b&&void 0!==c&&this.notify([a],c))},complete:function(a,e,b){"pending"===this.state?(this.state=a,this.value=e,this.notify(b,e),this.releaseCallbacks()):Ext.Error.raise("Error: this Deferred has already been completed and cannot be modified.")},notify:function(a,e){var b,c,d;c=0;for(d=a.length;c<d;c++)b=a[c],b(e)},releaseCallbacks:function(){this.cancelCallbacks=this.failureCallbacks=this.successCallbacks=this.progressCallbacks=null}});
Ext.define("Deft.promise.Promise",{alternateClassName:["Deft.Promise"],statics:{when:function(a,e){var b;if(a instanceof Ext.ClassManager.get("Deft.promise.Promise")||a instanceof Ext.ClassManager.get("Deft.promise.Deferred"))return a.then(e);b=Ext.create("Deft.promise.Deferred");b.resolve(a);return b.then(e)},all:function(a,e){return this.when(this.reduce(a,this.reduceIntoArray,Array(a.length)),e)},any:function(a,e){var b,c,d,f,g,i,j,h,k,l;c=Ext.create("Deft.promise.Deferred");k=function(a){c.update(a)};
h=function(a){b();c.resolve(a)};b=function(){return k=h=function(){}};j=function(a){return h(a)};i=function(a){return rejector(a)};f=function(a){return k(a)};d=0;for(l=a.length;d<l;d++)g=a[d],d in a&&this.when(g,j,i,f);return c.then(e)},map:function(a,e){var b,c,d,f;d=Array(a.length);b=0;for(f=a.length;b<f;b++)c=a[b],b in a&&(d[b]=this.when(c,e));return this.reduce(d,this.reduceIntoArray,d)},reduce:function(a,e,b){var c,d;d=this.when;c=[function(b,c,i){return d(b,function(b){return d(c,function(c){return e(b,
c,i,a)})})}];3===arguments.length&&c.push(b);return this.when(this.reduceArray.apply(a,c))},reduceArray:function(a,e){var b,c,d,f,g;d=0;c=Object(this);f=c.length>>>0;b=arguments;if(1>=b.length)for(;;){if(d in c){g=c[d++];break}if(++d>=f)throw new TypeError;}else g=b[1];for(;d<f;)d in c&&(g=a(g,c[d],d,c)),d++;return g},reduceIntoArray:function(a,e,b){a[b]=e;return a}},constructor:function(a){this.deferred=a;return this},then:function(a){return this.deferred.then.apply(this.deferred,arguments)},always:function(a){return this.deferred.always(a)},
cancel:function(a){return this.deferred.cancel(a)},getState:function(){return this.deferred.getState()}},function(){null!=Array.prototype.reduce&&(this.reduceArray=Array.prototype.reduce)});
